(()=>{"use strict";var e,t={7763:(e,t,n)=>{var o=n(7294),r=n(3935),a=n(9704),i=n(3243),l=n(9755),s=n.n(l),c=n(6486),d=n.n(c),u=n(5317),p=n(4184),m=n.n(p);const f={Icon:"UIcon-Icon_3sS7J",icon:"UIcon-Icon_3sS7J",subdued:"UIcon-subdued_2tv4C",success:"UIcon-success_3Y5eX",critical:"UIcon-critical_3Ykd2"},MdiWrapper=e=>()=>o.createElement("svg",{fill:"#000000",height:"24",viewBox:"0 0 24 24",width:"24"},o.createElement("path",{d:e})),g={Undo:MdiWrapper(u.A44),CalendarClock:MdiWrapper(u.$Og),ContentCopy:MdiWrapper(u.a0Z),OpenInNew:MdiWrapper(u.fOx),EmailOpenOutline:MdiWrapper(u.r7n),TrashCanOutline:MdiWrapper(u.j43),Magnify:MdiWrapper(u.I0v),StarOutline:MdiWrapper(u.KCi),Star:MdiWrapper(u.Vip),StarHalfFull:MdiWrapper(u.FmA),Lifebuoy:MdiWrapper(u.azf),PencilOutline:MdiWrapper(u.I$6),MessageDraw:MdiWrapper(u.ivu),HelpCircleOutline:MdiWrapper(u.Gir),AccountGroupOutline:MdiWrapper(u.OD4),TextBoxMultipleOutline:MdiWrapper(u.cJi),Youtube:MdiWrapper(u.Vmg),BellOutline:MdiWrapper(u.QWc),InformationVariant:MdiWrapper(u.gCD),AlertOutline:MdiWrapper(u.O8k),AlertCircleOutline:MdiWrapper(u._gM),InformationOutline:MdiWrapper(u.EaN),BookmarkCheckOutline:MdiWrapper(u.HrL),CheckAll:MdiWrapper(u.uhZ),Check:MdiWrapper(u.oL1),TableDefault:MdiWrapper(u._sG),FolderTable:MdiWrapper(u.Uhd),DotsGrid:MdiWrapper(u.kvM),ViewGridOutline:MdiWrapper(u.fc6),CreditCardMultipleOutline:MdiWrapper(u.v1t),DatabaseCogOutline:MdiWrapper(u.zMm),DatabaseOutline:MdiWrapper(u.gRl),DatabaseArrowUpOutline:MdiWrapper(u.tdL),Autorenew:MdiWrapper(u.CbH),CloseCircle:MdiWrapper(u.lY3),ClockOutline:MdiWrapper(u.R1X),Close:MdiWrapper(u.r5M),ArrowLeft:MdiWrapper(u.J3k),ArrowRight:MdiWrapper(u.aIO),ViewDashboard:MdiWrapper(u.Ccq),ViewDashboardOutline:MdiWrapper(u.V7Q),FileTableOutline:MdiWrapper(u.iq9),ClipboardTextOutline:MdiWrapper(u.KHR),History:MdiWrapper(u.BBX),Refresh:MdiWrapper(u.jcD),Folder:MdiWrapper(u.in3),FormatPaint:MdiWrapper(u.tdF),SetCenter:MdiWrapper(u.pWx),FolderOpen:MdiWrapper(u.IC9),File:MdiWrapper(u.iA5),CodeTags:MdiWrapper(u.Nnu),TagMultipleOutline:MdiWrapper(u.UXY),FileOutline:MdiWrapper(u.FA_),FileMultipleOutline:MdiWrapper(u.lJD),FileTree:MdiWrapper(u.CWK),CubeOutline:MdiWrapper(u.nd9),PlayCircleOutline:MdiWrapper(u.g3n),PlayOutline:MdiWrapper(u.E2E),PlaylistCheck:MdiWrapper(u.a3f),TableOutline:MdiWrapper(u._sG),FamilyTree:MdiWrapper(u.qym),HomeOutline:MdiWrapper(u.C1V),FileTreeOutline:MdiWrapper(u.b35),FileExportOutline:MdiWrapper(u.Vl2),FileDownloadOutline:MdiWrapper(u.wLz),TrayArrowDown:MdiWrapper(u.JEL),ExportVariant:MdiWrapper(u.epm),GoogleSpreadsheet:MdiWrapper(u.kOW),Xml:MdiWrapper(u.SMx),DotsVertical:MdiWrapper(u.SXi),DotsHorizontal:MdiWrapper(u.XMI),ContentSaveOutline:MdiWrapper(u.JTj),Printer:MdiWrapper(u.S0t),Pin:MdiWrapper(u.GFF),MapMarkerOutline:MdiWrapper(u.CJv),TruckDeliveryOutline:MdiWrapper(u.bfJ),PackageVariantClosed:MdiWrapper(u.$gb),CashMultiple:MdiWrapper(u.OK9),CashRefund:MdiWrapper(u.L5u),Poll:MdiWrapper(u.a$o),ClipboardListOutline:MdiWrapper(u.mMg),Bank:MdiWrapper(u.Q39),CogOutline:MdiWrapper(u.eYM),ApplicationEditOutline:MdiWrapper(u.XtE),ApplicationEdit:MdiWrapper(u.Xjq),ThumbUpOutline:MdiWrapper(u.Toh),ThumbDownOutline:MdiWrapper(u.uTd),ChevronDown:MdiWrapper(u.CW),ChevronUp:MdiWrapper(u.Waq),ChevronLeft:MdiWrapper(u.gAv),ChevronRight:MdiWrapper(u.zrb),MenuDown:MdiWrapper(u.iW9),MenuRight:MdiWrapper(u.ozb),Menu:MdiWrapper(u.$Qi),MenuOpen:MdiWrapper(u.XIn),FilterPlusOutline:MdiWrapper(u.s4y),FilterMultipleOutline:MdiWrapper(u.d3r),FilterOutline:MdiWrapper(u.Qbm),RelationManyToMany:MdiWrapper(u.CWw),FilterCogOutline:MdiWrapper(u.xg5),FilterVariant:MdiWrapper(u.ghd),FilterVariantPlus:MdiWrapper(u.rpe),TableColumnRemove:MdiWrapper(u.x5z),TableHeadersEye:MdiWrapper(u.WY_),ArrowSplitVertical:MdiWrapper(u.Vy),Eye:MdiWrapper(u.rgx),EyeOff:MdiWrapper(u.DqW),ToggleSwitch:MdiWrapper(u.vbV),ToggleSwitchOff:MdiWrapper(u.$dY),ToggleSwitchOutline:MdiWrapper(u.$hB),ToggleSwitchOffOutline:MdiWrapper(u.Baq),DragVertical:MdiWrapper(u.GFQ),SortAlphabeticalAscending:MdiWrapper(u.L0I),SortAlphabeticalDescending:MdiWrapper(u.P18),SortNumericAscending:MdiWrapper(u.v7Y),SortNumericDescending:MdiWrapper(u.eIQ),Numeric:MdiWrapper(u.tkb),Assistant:MdiWrapper(u.A9A),StarFourPoints:MdiWrapper(u.XGP),Plus:MdiWrapper(u.qX5),ViewGridPlus:MdiWrapper(u.ZAH),Compass:MdiWrapper(u.U2$),TableSearch:MdiWrapper(u.YW3),Blank:MdiWrapper(""),EmailNewsletter:MdiWrapper(u.Bqu),Email:MdiWrapper(u.XH8),ObjectTableList:MdiWrapper(u.Qdr),ObjectTable:MdiWrapper(u._sG),ObjectColumnDimension:MdiWrapper(u.Nnu),ObjectColumnMeasure:MdiWrapper(u.tkb),ObjectRelationship:MdiWrapper(u.pWx),ObjectExplore:MdiWrapper(u.U2$),ObjectModel:MdiWrapper(u.bl5),MessageProcessingOutline:MdiWrapper(u.MCL)},UIcon_UIcon=e=>{const t={cursor:e.onClick?"pointer":void 0};return o.createElement("div",{className:m()(f.Icon,e.color&&f[e.color],e.className),style:t,onClick:e.onClick},e.source)};new class FormService{constructor(){this.findValues=()=>{const e=new Map;return d().each(s()("input, select"),(t=>{const n=s()(t),o=n.attr("name"),r=n.val();o&&r&&(e[o]=r.toString())})),e}}};var y=n(5096),h=n.n(y);const v=JSON.parse('{"$schema":"http://json-schema.org/draft-07/schema#","$ref":"#/definitions/ITsValidator","definitions":{"ITsValidator":{"type":"object","properties":{"ITextRequest":{"$ref":"#/definitions/ITextRequest"},"ITextResponse":{"$ref":"#/definitions/ITextResponse"},"IConfig":{"$ref":"#/definitions/IConfig"}},"required":["ITextRequest","ITextResponse","IConfig"],"additionalProperties":false},"ITextRequest":{"type":"object","properties":{"id":{"type":"string"},"prompt":{"type":"string"}},"required":["id","prompt"],"additionalProperties":false},"ITextResponse":{"type":"object","properties":{"answer":{"type":"string"}},"required":["answer"],"additionalProperties":false},"IConfig":{"type":"object","properties":{"apiURL":{"type":"string"},"cssURL":{"type":"string"},"context":{"type":"array","items":{"$ref":"#/definitions/IContextItem"}},"promptList":{"type":"array","items":{"$ref":"#/definitions/IPrompt"}},"modelList":{"type":"array","items":{"$ref":"#/definitions/IAIModel"}}},"required":["apiURL","cssURL","context","promptList","modelList"],"additionalProperties":false},"IContextItem":{"type":"object","properties":{"id":{"type":"string"},"code":{"type":"string"},"label":{"type":"string"},"value":{"type":"string"}},"required":["id","label","value"],"additionalProperties":false},"IAIModel":{"type":"object","properties":{"label":{"type":"string"},"value":{"type":"string"}},"required":["label","value"],"additionalProperties":false},"IPrompt":{"type":"object","properties":{"id":{"type":"string"},"code":{"type":"string"},"title":{"type":"string"},"prompt":{"type":"string"},"placeholder":{"type":"string"},"scopes":{"type":"array","items":{"type":"string"}},"fieldSelector":{"type":"string"},"isModal":{"type":"boolean"},"aiModel":{"type":"string"}},"required":["id","code","title","prompt","scopes","fieldSelector","isModal","aiModel"],"additionalProperties":false}}}'),E=new(h());E.addSchema(v,"Schema");const tsValidate=(e,t)=>t;const b=new class ConfigService{constructor(){this.config=this.get("CONFIG"),tsValidate(0,this.config)}get(e){const t=window;return!!t[e=`MST_ASSISTANT_${e}`]&&t[e]}};const w=new class ContextService{contextScopes(e){return d().uniq(d().map(e,(e=>e.id.split(".")[0])))}};var O=n(3418),C=(n(4500),n(2964)),S=n(3154);const T=(0,O.HF)({}),A=T.getSelectors(),I=Object.assign({},T.getInitialState()),x=(0,O.oM)({initialState:I,name:"CONTEXT",reducers:{setAll:(e,t)=>{T.setAll(e,t.payload)},add:(e,t)=>{T.addOne(e,t.payload)},unset:(e,t)=>{T.removeOne(e,t.payload)},update:(e,t)=>{T.updateOne(e,t.payload)}}}),k=x.actions,M=x.reducer;var L=n(4586);const N=(0,O.HF)({}),_=N.getSelectors(),P=Object.assign({},N.getInitialState()),j=(0,O.oM)({initialState:P,name:"TOAST",reducers:{setAll:(e,t)=>{N.setAll(e,t.payload)},add:(e,t)=>{N.addOne(e,t.payload)},unset:(e,t)=>{N.removeOne(e,t.payload)},update:(e,t)=>{N.updateOne(e,t.payload)},removeAll:e=>{N.removeAll(e)},error:(e,t)=>{N.addOne(e,{id:(0,L.Z)(),type:"error",content:t.payload,time:Date.now(),duration:5e3})}}}),D=j.actions,R=j.reducer,F=(0,O.HF)({}),q=F.getSelectors(),U=Object.assign(Object.assign({},F.getInitialState()),{loadingState:"pending",errorText:""}),B=(0,O.oM)({initialState:U,name:"PROMPT",reducers:{loadingState:(e,t)=>{e.loadingState=t.payload},errorText:(e,t)=>{e.errorText=t.payload},setAll:(e,t)=>{F.setAll(e,t.payload)},add:(e,t)=>{F.addOne(e,t.payload)},unset:(e,t)=>{F.removeOne(e,t.payload)},update:(e,t)=>{F.updateOne(e,t.payload)}}}),V=B.actions,H=B.reducer,z=(0,S.UY)({context:M,prompt:H,toast:R});var $=n(4857),X=n(6700);const G={init:function*(){yield*(0,X.gz)(k.setAll(b.config.context))}};const W=n(2956).Z.create({timeout:3e7,withCredentials:!1,responseType:"json"}),Y=window.MST_ASSISTANT_CONFIG.apiURL,assistantRestApi_process=e=>{return t="ITextResponse",n="POST",r=e,o=Y+(o="api/text"),Date.now(),W(Object.assign({method:n,url:o,data:r,headers:{"X-App-Version":"0.0.0"}},a)).then((e=>{if(!0===e.data.success){const n=e.data.data,o=String(e.data.message);return t&&tsValidate(0,n),{data:n,message:o,error:null}}return e.data.message&&e.data.message.includes("version mismatch")&&window.location.reload(),{error:e.data.message?e.data.message:"Undefined error",errors:e.data.errors}})).catch((e=>({error:e.message?`${e.message}: ${o}`:`Undefined error: ${o}`,errors:{}})));var t,n,o,r,a},Q={init:function*(){},process:function*(e,t){t.before();const n=yield*(0,X.RE)(assistantRestApi_process,e);t.finally(n)}},J={init:function*(){yield*(0,X.gz)(V.setAll(b.config.promptList))}};function*rootSaga(){yield(0,$.$6)([G.init(),J.init(),Q.init()])}const{store:K,runSaga:Z}=function setupStore(e={}){const t=(0,C.ZP)(),n=[t],o=(0,O.xC)({reducer:z,middleware:[...(0,O.Bx)({thunk:!1,serializableCheck:!1}),...n],preloadedState:e,devTools:!1});return t.run(rootSaga),{store:o,runSaga:t.run}}(),store_useRootDispatch=()=>(0,a.I0)(),ee=a.v9,context_selector_useContextSelector=()=>(0,a.v9)((e=>({context:A.selectAll(e.context)})),d().isEqual),useContextItemSelector=e=>(0,a.v9)((e=>t=>({contextItem:A.selectById(t.context,e)}))(e),d().isEqual),usePromptListSelector=()=>(0,a.v9)((e=>{const{context:t}=context_selector_useContextSelector(),n=q.selectAll(e.prompt);return{promptList:n,applicablePromptList:d().filter(n,(e=>{if(0==e.scopes.length)return!0;let n=!1;return d().each(e.scopes,(e=>{d().indexOf(w.contextScopes(t),e)>=0&&(n=!0)})),n}))}}),d().isEqual),usePromptSelector=e=>(0,a.v9)((e=>t=>({prompt:q.selectById(t.prompt,e)}))(e),d().isEqual);var te=n(6739);const useToast=()=>{const e=store_useRootDispatch(),t=(e,t,n)=>{let o=5e3;return"loading"==e&&(o=0),"error"==e&&(o=1e4),Object.assign({content:t,id:(0,L.Z)(),type:e,time:Date.now(),duration:o},n)},n=t=>(e(D.add(t)),t.id);return{success:(e,o)=>n(t("success",e,o)),error:(e,o)=>n(t("error",e,o)),info:(e,o)=>n(t("info",e,o)),loading:(e,o)=>n(t("loading",e,o)),update:(t,n)=>{e(D.update({id:t,changes:Object.assign({time:Date.now(),duration:5e3},n)}))},unset:t=>{e(D.unset(t))},removeAll:()=>{e(D.removeAll())}}};var ne=n(1220),oe=n(6500),re=n(7932),ae=n(9669),ie=n(4497);function makeCallback(e){return e?{before:e.before?e.before:()=>{},success:e.success?e.success:()=>{},fail:e.fail?e.fail:()=>{},always:e.always?e.always:()=>{},finally:t=>{null===t.error?e.success&&e.success(t):e.fail&&e.fail(t),e.always&&e.always(),e.finally&&e.finally(t)}}:{before:()=>{},success:()=>{},fail:()=>{},always:()=>{},finally:()=>{}}}var le=n(6620);const se=new class PromptService{render(e,t){const n=new le.Kj,o={};d().each(t,(e=>{const[t,n]=e.id.split(".");null==o[t]&&(o[t]={}),o[t][n]=e.value}));try{return n.parseAndRenderSync(e.prompt,o,{})}catch(e){return e.toString()}}},useAssistantDispatcher=()=>({process:(e,t)=>{Z(Q.process,e,makeCallback(t))},adHoc:(e,t,n,o,r)=>{t.push({label:"Input",id:"global.input",value:n});const a={id:e.id,prompt:se.render(e,t),aiModel:e.aiModel};console.log(a.prompt),Z(Q.process,a,makeCallback({success:e=>{o(e.data.answer)},fail:e=>{r(e.error)}}))}}),useToggle=e=>{const[t,n]=(0,o.useState)(e),r=(0,o.useCallback)((()=>n(!0)),[]),a=(0,o.useCallback)((()=>n(!1)),[]),i=(0,o.useCallback)((()=>n(!t)),[t]);return{active:t,on:r,off:a,toggle:i}};var ce=n(5489);const PromptSelector=e=>{const{applicablePromptList:t}=usePromptListSelector(),n=useToggle(!1);(0,o.useEffect)((()=>{""==e.promptID&&e.onChange(t[0].id)}),[]);d().find(t,{id:e.promptID});const r=d().map(d().filter(t),(e=>({value:e.id,label:e.title})));return o.createElement(ce.P,{label:"Prompt",options:r,value:e.promptID,labelInline:!0,onChange:t=>{e.onChange(t),n.off()}})},AIModelSelector=e=>{const t=useToggle(!1),n=b.config.modelList;return o.createElement(ce.P,{label:"AI Model",options:n,value:e.aiModel,labelInline:!0,onChange:n=>{e.onChange(n),t.off()}})};var de=n(640),ue=n.n(de);const pe="QAItem-Answer_3hJ46",me="QAItem-Error_1lSP6",fe="QAItem-PromptTitle_3Az3i",ge="QAItem-Controls_LRU47",ye="QAItem-Counter_1t1nW",QAItem_QAItem=e=>{const t=useToast(),{item:n}=e;return o.createElement("div",{className:m()(pe,n.error&&me)},o.createElement("div",{className:fe,onClick:()=>{n.prompt&&ue()(n.prompt),t.success("The prompt copied")},title:"Click here to copy prompt"},n.promptTitle),n.selector.match(/meta[_\-]/is)&&n.answer&&o.createElement("div",{className:ye},n.answer.length+" character(s)"),n.answer,n.error,n.loading&&o.createElement(UIcon_UIcon,{source:g.DotsHorizontal()}),e.onApply&&n.answer&&o.createElement("div",{className:ge},o.createElement(re.h,null,o.createElement(ae.z,{onClick:()=>{n.answer&&ue()(n.answer),t.success("Copied!")}},"Copy"),o.createElement(ae.z,{primary:!0,onClick:()=>{n.answer&&e.onApply&&e.onApply(n.answer)}},"Apply"))))},Assistant=e=>{const t=useToast(),[n,r]=(0,o.useState)(e.prompt?e.prompt.id:""),[a,i]=(0,o.useState)(e.prompt?e.prompt.aiModel:""),{context:l}=context_selector_useContextSelector(),{contextItem:s}=useContextItemSelector("global.input"),{prompt:c}=usePromptSelector(n),u=useToggle(!1),p=useAssistantDispatcher(),m=(()=>{const e=store_useRootDispatch();return{update:(t,n)=>{e(k.update({id:t,changes:n}))}}})(),[f,g]=(0,o.useState)([]);(0,o.useEffect)((()=>{const e=d().findIndex(f,{ready:!1,loading:!1});if(-1==e)return;const n=f[e];p.process({id:n.promptID,prompt:n.prompt,aiModel:a},{before:()=>{updateQAItem(e,{loading:!0}),u.on()},success:t=>{updateQAItem(e,{answer:t.data.answer,loading:!1,ready:!0})},fail:n=>{updateQAItem(e,{error:n.error,loading:!1,ready:!0}),t.error(n.error)},finally:()=>u.off()})}),[f]);const updateQAItem=(e,t)=>{const n=d().cloneDeep(f);n[e]=Object.assign(Object.assign({},n[e]),t),g(n)};return o.createElement(ne.u,{open:e.open,title:"AI Assistant",large:!0,onClose:e.onClose},o.createElement(ne.u.Section,null,o.createElement(oe.K,{vertical:!0},o.createElement(oe.K,null,o.createElement(oe.K.Item,{fill:!0},o.createElement(re.h,null,o.createElement(ae.z,{loading:u.active,primary:!0,onClick:()=>{const e=se.render(c,l);g([{promptID:c.id,prompt:e,promptTitle:c.title,input:s.value,ready:!1,loading:!1,selector:c.fieldSelector,aiModel:c.aiModel},...f])}},"Generate"))),o.createElement(AIModelSelector,{aiModel:a,onChange:i}),o.createElement(PromptSelector,{promptID:n,onChange:e=>{r(e);const t=d().find(b.config.promptList,{id:e});t&&i(t.aiModel)}})),o.createElement(ie.n,{autoComplete:"off",label:"",multiline:2,placeholder:c?c.placeholder:"",value:s.value,labelHidden:!0,onChange:e=>{m.update(s.id,{value:e})}}))),f.length>0&&o.createElement(ne.u.Section,null,o.createElement(oe.K,{vertical:!0},d().map(f,((t,n)=>o.createElement(QAItem_QAItem,{key:n,item:t,onApply:e.onApply}))))))},he="ActionButton-ActionButton_3fyGP",ve="ActionButton-Loading_12aOF",ActionButton_ActionButton=e=>{const{prompt:t}=e,n=useToggle(!1),r=useAssistantDispatcher(),{context:a}=context_selector_useContextSelector(),i=useToast(),l=useToggle(!1),s=o.createElement("div",{className:m()(he,n.active&&ve),onClick:()=>{t.isModal?l.on():(n.on(),e.onLoading(!0),r.adHoc(t,a,e.text,(t=>{e.onChange(t),n.off(),e.onLoading(!1)}),(t=>{i.error(t),n.off(),e.onLoading(!1)})))},title:t.placeholder},t.title);""!=t.placeholder&&o.createElement(te.u,{content:t.placeholder,preferredPosition:"mostSpace",width:"wide"},s);return o.createElement(o.Fragment,null,s,o.createElement(Assistant,{open:l.active,prompt:t,onApply:t=>{e.onChange(t),l.off()},onClose:l.off}))},Ee="Element-AreaContainer_3EjKf",be="Element-Stale_VvCI2",we="Element-Undo_3y2Hr",Oe="Element-Counter_1RVaA",Ce="Element-Actions_21Sla",Se="Element-DotTyping_-rE-J",useRect=e=>{const[t,n]=(0,o.useState)({left:0,top:0,width:0,height:0,position:"fixed"});const r=()=>{const t=e.getBoundingClientRect();let o=e.offsetTop,r=e.offsetLeft,a=t.width,i=t.height;const l=document.querySelector("iframe#"+e.id+"_ifr");if(l&&l.closest(".admin__control-wysiwig")){const e=l.closest(".admin__control-wysiwig"),t=l.getBoundingClientRect();o=e.offsetTop+48,r=e.offsetLeft,a=t.width,i=t.height}n({top:o,left:r,width:a,height:i,position:a?"absolute":"fixed"})};return(0,o.useEffect)((()=>{const t=function observeBounds(e,t){const n=function observeScroll(e,t){const n=n=>{n.target.contains(e)&&t()};return document.addEventListener("scroll",n,{capture:!0}),()=>{document.removeEventListener("scroll",n,{capture:!0})}}(e,t),o=function observeSize(e,t){const n=new ResizeObserver((()=>{t()}));return n.observe(e),()=>{n.disconnect()}}(e,t),r=function observePosition(e,t){const n=document.createElement("div");"TEXTAREA"!=e.tagName&&"INPUT"!=e.tagName||e.parentElement&&(e=e.parentElement);Object.assign(n.style,{position:"fixed",pointerEvents:"none",width:"2px",height:"2px"}),e.appendChild(n);const o=()=>{const e=n.getBoundingClientRect();Object.assign(n.style,{marginLeft:parseFloat(n.style.marginLeft||"0")-e.left-1+"px",marginTop:parseFloat(n.style.marginTop||"0")-e.top-1+"px"})};o();const r=new IntersectionObserver((e=>{1!==Math.round(4*e[0].intersectionRatio)&&(o(),t())}),{threshold:[.125,.375,.625,.875]});return r.observe(n),()=>{r.disconnect(),n.remove()}}(e,t);return()=>{n(),o(),r()}}(e,r);return()=>{t()}}),[]),t};const Element_Element=e=>{const{el:t}=e,n=useRect(t),{applicablePromptList:r}=usePromptListSelector(),a=useToggle(!1),i=useToggle(!1),[l,c]=(0,o.useState)(""),u=s()(t),p=(0,o.useRef)(),{width:f}=(e=>{const[t,n]=(0,o.useState)({width:0,height:0});return(0,o.useEffect)((()=>{const getDimensions=()=>({width:e.current.offsetWidth,height:e.current.offsetHeight}),handleResize=()=>{e.current&&n(getDimensions())};return e.current&&n(getDimensions()),setInterval(handleResize,100),window.addEventListener("resize",handleResize),()=>{window.removeEventListener("resize",handleResize)}}),[e.current]),t})(p),{selectionValue:y,selectionFocus:h,selectionStart:v,selectionEnd:E}=(e=>{const t=e,[n,r]=(0,o.useState)(0),[a,i]=(0,o.useState)(0),[l,s]=(0,o.useState)(""),[c,d]=(0,o.useState)(!1),[u,p]=(0,o.useState)({left:0,top:0,width:0,height:0,position:"relative"}),m=()=>{let e=t.selectionStart,n=t.selectionEnd,o=t.value?t.value.substring(e,n):"";if("INPUT"!==t.tagName&&"TEXTAREA"!==t.tagName){const r=document.getSelection();e=r.anchorOffset,n=r.focusOffset,o=t.innerHTML.substring(e,n)}const a=document.querySelector("iframe#"+t.id+"_ifr");if(a){const t=a.contentWindow.document,r=t.getSelection(),i=t.querySelector("body").innerHTML,l=(r.anchorNode?i.indexOf(r.anchorNode.textContent):0)+r.anchorOffset;e=l<0?0:l,n=e+((r.focusNode?i.indexOf(r.focusNode.textContent):0)+r.focusOffset-l),o=i.substring(e,n)}r(e),i(n),s(o)},onFocus=()=>{d(!0)},onBlur=()=>{d(!1)};return(0,o.useEffect)((()=>(m(),window.addEventListener("mousedown",m),window.addEventListener("mouseup",m),e.addEventListener("focus",onFocus),e.addEventListener("blur",onBlur),window.addEventListener("mouseup",(e=>{p(Object.assign(Object.assign({},u),{left:e.x,top:e.y}))})),()=>{window.removeEventListener("mousedown",m),window.removeEventListener("mouseup",m),e.removeEventListener("focus",onFocus),e.removeEventListener("blur",onBlur)})),[]),{selectionStart:n,selectionEnd:a,selectionValue:l,selectionFocus:c,selectionRect:u}})(t);let b="";const w={top:n.top,left:n.left,width:n.width,height:n.height,position:n.position,background:"transparent"},updateWysiwyg=e=>{const t=document.querySelector("iframe#"+u.attr("id")+"_ifr");t&&(t.contentWindow.document.querySelector("body").innerHTML=e)},onValueUpdate=e=>{let n=e;const o=getElementValue();if(c(o),y){const t=o;n=t.substring(0,v)+e+t.substring(E)}updateValue(n),updateWysiwyg(n);const r=document.createEvent("HTMLEvents");r.initEvent("change",!0,!0),t.dispatchEvent(r)},updateValue=e=>("INPUT"!=u[0].tagName&&"TEXTAREA"!=u[0].tagName||u.val(e),u.removeClass("placeholder-text"),u.html(e)),getElementValue=()=>{if("INPUT"==u[0].tagName||"TEXTAREA"==u[0].tagName){let e=u.val();return document.querySelector("iframe#"+u.attr("id")+"_ifr")&&(e=e.replace(/\r?\n|\r/g,"")),e}return u[0].innerHTML},O=d().filter(d().map(r,(e=>{if(""!==e.fieldSelector){if(!t.matches(e.fieldSelector))return null;b||(b=e.fieldSelector)}return o.createElement(ActionButton_ActionButton,{key:e.id,prompt:e,text:y||u.val(),onChange:onValueUpdate,onLoading:e=>{e?(i.on(),c("")):i.off()}})})),(e=>!d().isNull(e)));if(0===O.length)return null;const C=o.createElement("div",{className:be},i.active?o.createElement("div",{className:Se}):o.createElement("svg",{fill:"#0167d3",focusable:"false",viewBox:"0 0 20 20"},o.createElement("path",{d:"M12.643 7.61c.124-.376.186-.564.288-.599a.216.216 0 0 1 .138 0c.102.035.164.223.288.6.519 1.577.778 2.366 1.268 2.991.225.288.485.548.773.773.625.49 1.414.75 2.991 1.268.377.124.565.186.6.288a.217.217 0 0 1 0 .138c-.035.102-.223.164-.6.288-1.577.519-2.366.778-2.991 1.268a4.53 4.53 0 0 0-.773.773c-.49.625-.75 1.414-1.268 2.991-.124.377-.186.565-.288.6a.217.217 0 0 1-.138 0c-.102-.035-.164-.223-.288-.6-.519-1.577-.778-2.366-1.268-2.991a4.53 4.53 0 0 0-.773-.773c-.625-.49-1.414-.75-2.991-1.268-.377-.124-.565-.186-.6-.288a.216.216 0 0 1 0-.138c.035-.102.223-.164.6-.288 1.577-.519 2.366-.778 2.991-1.268a4.53 4.53 0 0 0 .773-.773c.49-.625.75-1.414 1.268-2.991Z"}),o.createElement("path",{d:"M4.762 4.407c.083-.251.124-.377.192-.4.03-.01.062-.01.092 0 .068.023.11.149.192.4.346 1.052.519 1.578.845 1.994.15.192.324.365.516.516.416.326.942.5 1.994.845.251.083.377.124.4.192.01.03.01.062 0 .092-.023.068-.149.11-.4.192-1.052.346-1.578.519-1.994.845-.192.15-.365.324-.516.516-.326.416-.5.942-.845 1.994-.083.251-.124.377-.192.4a.144.144 0 0 1-.092 0c-.068-.023-.11-.149-.192-.4-.346-1.052-.519-1.578-.845-1.994a3.022 3.022 0 0 0-.516-.516c-.416-.326-.942-.5-1.994-.845-.251-.083-.377-.124-.4-.192a.144.144 0 0 1 0-.092c.023-.068.149-.11.4-.192 1.052-.346 1.578-.519 1.994-.845.192-.15.365-.324.516-.516.326-.416.5-.942.845-1.994Z"}),o.createElement("path",{d:"M10.351 1.254c.052-.157.078-.235.12-.25a.09.09 0 0 1 .058 0c.042.015.068.093.12.25.216.658.324.986.528 1.247.094.12.202.228.322.322.26.204.59.312 1.247.528.156.052.235.078.25.12a.089.089 0 0 1 0 .058c-.015.042-.094.068-.25.12-.658.216-.987.324-1.247.528-.12.094-.228.202-.322.322-.204.26-.312.59-.528 1.247-.052.156-.078.235-.12.25a.09.09 0 0 1-.058 0c-.042-.015-.068-.094-.12-.25-.216-.658-.324-.986-.528-1.247a1.888 1.888 0 0 0-.322-.322c-.26-.204-.59-.312-1.247-.528-.156-.052-.235-.078-.25-.12a.09.09 0 0 1 0-.058c.015-.042.094-.068.25-.12.658-.216.986-.324 1.247-.528.12-.094.228-.202.322-.322.204-.26.312-.59.528-1.247Z"}))),S=a.active||i.active||""!=y&&h;return o.createElement("div",{className:Ee,style:w},l&&b.match(/meta[_\-]/is)&&o.createElement("div",{className:Oe},u.val().length+" character(s)"),l&&o.createElement("div",{className:we,onClick:()=>{updateValue(l),updateWysiwyg(l),c("")}},g.Undo()),o.createElement("div",{className:m()(Ce),style:{width:S?f:"36px"},onMouseEnter:a.on,onMouseLeave:a.off},o.createElement("div",{ref:p},C," ",O)))},ButtonPlacer=()=>{const e={render:(e,t)=>{const n=document.createElement("mst-assistant");e.appendChild(n),n.style.position="absolute",n.style.top="0px",n.style.left="0px",n.style.pointerEvents="none",n.style.zIndex="100",n.setAttribute("contenteditable","true");const l=n.attachShadow({mode:"open"});(0,r.render)(o.createElement(a.zt,{store:K},o.createElement(i.w,{i18n:{}},o.createElement("link",{href:b.config.cssURL,media:"all",rel:"stylesheet",type:"text/css"}),t,o.createElement("style",null,"\n                            @keyframes p-keyframes-bounce { from, 65%, 85% { transform: scale(1); }\n                                75% { transform: scale(0.85); }\n                                82.5% { transform: scale(1.05); } }\n                            @keyframes p-keyframes-fade-in { to { opacity: 1; } }\n                            @keyframes p-keyframes-pulse { from, 75% { transform: scale(0.85);\n                                opacity: 1; }\n                                to { transform: scale(2.5);\n                                opacity: 0; } }\n                            @keyframes p-keyframes-spin { to { transform: rotate(1turn); } }\n                        "))),l)}},{applicablePromptList:t}=usePromptListSelector();return(0,o.useEffect)((()=>{setInterval((()=>{document.body.style.backgroundColor=null,document.body.style.color=null}),10)}),[]),(0,o.useEffect)((()=>{setInterval((()=>{d().each(s()('input[type=text], textarea, [contenteditable="true"]'),((n,r)=>{const a=s()(n).parent("div");if(0==a.length)return;if(s()("mst-assistant",a).length>0)return;const i=o.createElement(Element_Element,{key:r,el:n});return d().filter(d().map(t,(e=>{if(""!==e.fieldSelector&&!n.matches(e.fieldSelector))return null})),(e=>!d().isNull(e))).length>0&&e.render(a[0],i),null}))}),100)}),[]),null};var Te=n(3531);const Ae={Toast:"Toast-Toast_2DMvo",toast:"Toast-Toast_2DMvo",Body:"Toast-Body_18i7-",body:"Toast-Body_18i7-",Actions:"Toast-Actions_oYSl2",actions:"Toast-Actions_oYSl2",Action:"Toast-Action_2wjnY",action:"Toast-Action_2wjnY",error:"Toast-error_20hI4"},Toast_Toast=e=>{const{unset:t,update:n}=useToast(),{toast:r}=e;(0,o.useEffect)((()=>{const e=setInterval((()=>{r.duration>0&&r.time+r.duration<=Date.now()&&t(r.id)}),100);return()=>{clearInterval(e)}}),[r]);let a=d().map(r.content.split("\n"),((e,t)=>o.createElement("p",{key:t},e)));const i=r.actions?d().cloneDeep(r.actions):[];if("error"===r.type){const e=r.content.split(":"),t=r.content.split(":")[0];a=o.createElement("div",null,t),e.length>1&&i.push({content:"Details",onAction:()=>{alert(r.content)}})}return o.createElement("div",{className:m()(Ae.Toast,Ae[r.type]),onMouseEnter:()=>n(r.id,{duration:0})},o.createElement("div",{className:Ae.Body},a),i.length>0&&o.createElement("div",{className:Ae.Actions},d().map(i,(e=>o.createElement("div",{key:e.content,className:Ae.Action,onClick:()=>{t(r.id),e.onAction&&e.onAction()}},e.content)))),o.createElement(ae.z,{icon:g.Close(),plain:!0,onClick:()=>t(r.id)}))},Ie="ToastManager-ToastManager_2vMzA",ToastManager_ToastManager=()=>{const{toastList:e}=ee((e=>({toastList:_.selectAll(e.toast)})));return o.createElement(Te.h,null,o.createElement("div",{className:Ie},d().map(e,(e=>o.createElement(Toast_Toast,{key:e.id,toast:e})))))},xe="Application-Root_1x5DB",Application_Application=()=>{const e=useToggle(!1);return o.createElement(o.Fragment,null,o.createElement("div",{id:"root"},o.createElement("link",{href:b.config.cssURL,media:"all",rel:"stylesheet",type:"text/css"}),o.createElement("div",{className:xe},o.createElement(i.w,{i18n:{}},o.createElement(ButtonPlacer,null),o.createElement(Assistant,{open:e.active,onClose:e.off}),o.createElement(ToastManager_ToastManager,null)))),o.createElement("style",null,"\n            @keyframes p-keyframes-bounce { from, 65%, 85% { transform: scale(1); }\n                75% { transform: scale(0.85); }\n                82.5% { transform: scale(1.05); } }\n            @keyframes p-keyframes-fade-in { to { opacity: 1; } }\n            @keyframes p-keyframes-pulse { from, 75% { transform: scale(0.85);\n                opacity: 1; }\n                to { transform: scale(2.5);\n                opacity: 0; } }\n            @keyframes p-keyframes-spin { to { transform: rotate(1turn); } }\n        "))};!function(){const e=document.createElement("div");e.style.position="absolute",e.style.left="0",e.style.top="0",document.body.appendChild(e);const t=e.attachShadow({mode:"open"});(0,r.render)(o.createElement(a.zt,{store:K},o.createElement(Application_Application,null)),t)}()}},n={};function o(e){var r=n[e];if(void 0!==r)return r.exports;var a=n[e]={id:e,loaded:!1,exports:{}};return t[e].call(a.exports,a,a.exports,o),a.loaded=!0,a.exports}o.m=t,e=[],o.O=(t,n,r,a)=>{if(!n){var i=1/0;for(d=0;d<e.length;d++){for(var[n,r,a]=e[d],l=!0,s=0;s<n.length;s++)(!1&a||i>=a)&&Object.keys(o.O).every((e=>o.O[e](n[s])))?n.splice(s--,1):(l=!1,a<i&&(i=a));if(l){e.splice(d--,1);var c=r();void 0!==c&&(t=c)}}return t}a=a||0;for(var d=e.length;d>0&&e[d-1][2]>a;d--)e[d]=e[d-1];e[d]=[n,r,a]},o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),o.hmd=e=>((e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e),o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{var e={143:0};o.O.j=t=>0===e[t];var webpackJsonpCallback=(t,n)=>{var r,a,[i,l,s]=n,c=0;if(i.some((t=>0!==e[t]))){for(r in l)o.o(l,r)&&(o.m[r]=l[r]);if(s)var d=s(o)}for(t&&t(n);c<i.length;c++)a=i[c],o.o(e,a)&&e[a]&&e[a][0](),e[i[c]]=0;return o.O(d)},t=self.webpackChunkapp=self.webpackChunkapp||[];t.forEach(webpackJsonpCallback.bind(null,0)),t.push=webpackJsonpCallback.bind(null,t.push.bind(t))})();var r=o.O(void 0,[736],(()=>o(7763)));r=o.O(r)})();